{{ define "main" }}
<!-- Header Section - Full Width Title -->
<header class="mb-6 text-center w-full py-4">
  <!-- Title container: full width, no max-width constraints -->
  <div class="w-full px-4">
    <h1 class="text-5xl md:text-6xl lg:text-7xl font-bold text-gray-900 dark:text-white mb-4 leading-tight">
      {{ .Title }}
    </h1>
  </div>
</header>

<div class="container mx-auto px-4 py-4">
<article class="max-w-4xl mx-auto">
  <!-- Content Header Section -->
  <div class="mb-8 text-center">
    
    
    <!-- Authors -->
    {{ if .Params.authors }}
    <div class="mb-6">
      <div class="text-lg md:text-xl lg:text-2xl text-gray-700 dark:text-gray-300 leading-relaxed max-w-5xl mx-auto px-2">
        {{ $authorLinks := slice }}
        {{ range .Params.authors }}
          {{ $authorName := . }}
          {{ if eq . "admin" }}
            {{ $authorName = "Pengfei Shen" }}
            {{ $authorPage := site.GetPage "/authors/admin" }}
            {{ if and $authorPage $authorPage.Params.external_link }}
              {{ $authorLinks = $authorLinks | append (printf "<a href=\"%s\" target=\"_blank\" rel=\"noopener\" class=\"text-primary-600 dark:text-primary-400 hover:underline\">%s</a>" $authorPage.Params.external_link $authorName) }}
            {{ else }}
              {{ $authorLinks = $authorLinks | append $authorName }}
            {{ end }}
          {{ else }}
            {{ $authorName = . | replaceRE "\\^([0-9]+)\\^" "<sup>$1</sup>" | safeHTML }}
            {{ $authorPage := site.GetPage (printf "/authors/%s" .) }}
            {{ if and $authorPage $authorPage.Params.external_link }}
              {{ $authorLinks = $authorLinks | append (printf "<a href=\"%s\" target=\"_blank\" rel=\"noopener\" class=\"text-primary-600 dark:text-primary-400 hover:underline\">%s</a>" $authorPage.Params.external_link $authorName) }}
            {{ else }}
              {{ $authorLinks = $authorLinks | append $authorName }}
            {{ end }}
          {{ end }}
        {{ end }}
        <p class="mb-2">{{ delimit $authorLinks ", " | safeHTML }}</p>
        
        <!-- Author affiliations and notes -->
        {{ if .Params.author_affiliations }}
        <div class="text-sm text-gray-600 dark:text-gray-400 mt-2">
          {{ range .Params.author_affiliations }}
          <p class="mb-1">{{ . | markdownify }}</p>
          {{ end }}
        </div>
        {{ end }}
        
        {{ if .Params.author_notes }}
        <div class="text-sm text-gray-600 dark:text-gray-400 mt-2">
          {{ .Params.author_notes | markdownify }}
        </div>
        {{ end }}
      </div>
    </div>
    {{ end }}
    
    <!-- Publication Info -->
    {{ if .Params.publication }}
    <div class="mb-4">
      <p class="text-xl md:text-2xl font-semibold text-primary-700 dark:text-primary-300">
        {{ .Params.publication | markdownify }}
      </p>
    </div>
    {{ end }}
    
    <!-- Date -->
    <p class="text-lg text-gray-600 dark:text-gray-400 mb-8">
      {{ .Date | time.Format (site.Params.locale.date_format | default ":date_long") }}
    </p>
    
    <!-- Action Buttons -->
    {{ if or .Params.url_pdf .Params.external_link .Params.url_code .Params.url_video }}
    <div class="flex flex-wrap gap-3 mb-8">
      {{ if .Params.url_pdf }}
      <a href="{{ .Params.url_pdf }}" target="_blank" rel="noopener" 
         class="inline-flex items-center px-4 py-2 rounded-lg text-sm font-medium bg-blue-600 text-white hover:bg-blue-700 transition-colors">
        ðŸ“„ PDF
      </a>
      {{ end }}
      
      {{ if .Params.external_link }}
      <a href="{{ .Params.external_link }}" target="_blank" rel="noopener"
         class="inline-flex items-center px-4 py-2 rounded-lg text-sm font-medium bg-green-600 text-white hover:bg-green-700 transition-colors">
        ðŸ”— External Link
      </a>
      {{ end }}
      
      {{ if .Params.url_code }}
      <a href="{{ .Params.url_code }}" target="_blank" rel="noopener"
         class="inline-flex items-center px-4 py-2 rounded-lg text-sm font-medium bg-gray-800 text-white hover:bg-gray-900 transition-colors">
        ðŸ’» Code
      </a>
      {{ end }}
      
      {{ if .Params.url_video }}
      <a href="{{ .Params.url_video }}" target="_blank" rel="noopener"
         class="inline-flex items-center px-4 py-2 rounded-lg text-sm font-medium bg-red-600 text-white hover:bg-red-700 transition-colors">
        ðŸŽ¥ Video
      </a>
      {{ end }}
    </div>
    {{ end }}
  </div>
  
  <!-- Featured Image -->
  {{ $featured := .Resources.GetMatch "featured.*" }}
  {{ if $featured }}
  <div class="mb-8">
    <div class="max-w-4xl mx-auto mb-4">
      <img src="{{ $featured.RelPermalink }}" alt="{{ .Title }}" class="w-full h-auto rounded-lg shadow-lg">
    </div>
    {{ if .Params.featured_caption }}
    <div class="max-w-4xl mx-auto">
      <p class="text-sm md:text-base text-gray-600 dark:text-gray-400 text-center italic leading-relaxed">
        {{ .Params.featured_caption | markdownify }}
      </p>
    </div>
    {{ end }}
  </div>
  {{ end }}
  
  <!-- Abstract Section -->
  {{ if .Params.abstract }}
  <section class="mb-8">
    <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-4 text-center">Abstract</h2>
    <div class="max-w-4xl mx-auto">
      <div class="text-gray-700 dark:text-gray-300 leading-relaxed prose prose-lg dark:prose-invert max-w-none" style="text-align: justify; text-justify: inter-word;">
        {{ .Params.abstract | markdownify }}
      </div>
    </div>
  </section>
  {{ end }}
  
  <!-- Main Content -->
  {{ if .Content }}
  <section class="mb-8">
    <div class="max-w-4xl mx-auto prose prose-lg dark:prose-invert max-w-none" style="text-align: justify; text-justify: inter-word;">
      {{ .Content }}
    </div>
  </section>
  {{ end }}
  
  <!-- Summary Section -->
  {{ if .Params.summary }}
  <section class="mb-8">
    <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-4 text-center">Summary</h2>
    <div class="max-w-4xl mx-auto">
      <div class="text-gray-700 dark:text-gray-300 leading-relaxed prose prose-lg dark:prose-invert max-w-none" style="text-align: justify; text-justify: inter-word;">
        {{ .Params.summary | markdownify }}
      </div>
    </div>
  </section>
  {{ end }}
  
  <!-- Citation Section -->
  {{ if .Params.show_citation }}
  <section class="mb-8">
    <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-4 text-center">Citation</h2>
    <div class="max-w-4xl mx-auto">
      <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-4">
        <pre class="text-sm text-gray-800 dark:text-gray-200 text-left" style="white-space: pre-wrap; word-wrap: break-word; overflow-wrap: break-word; tab-size: 4;"><code>{{ if .Params.custom_citation }}{{ .Params.custom_citation }}{{ else }}@article{{ "{" }}{{ .Title | replaceRE "[^a-zA-Z0-9]" "" | lower }},
    title={{ "{" }}{{ .Title }}{{ "}" }},
    author={{ "{" }}{{ range $i, $author := .Params.authors }}{{ if $i }}, {{ end }}{{ if eq $author "admin" }}Pengfei Shen{{ else }}{{ $author | replaceRE "\\*$" "" | replaceRE "\\^[0-9]+\\^" "" }}{{ end }}{{ end }}{{ "}" }},
    year={{ "{" }}{{ .Date.Year }}{{ "}" }},{{ if .Params.publication_short }}
    journal={{ "{" }}{{ .Params.publication_short }}{{ "}" }},{{ end }}
{{ "}" }}{{ end }}</code></pre>
      </div>
    </div>
  </section>
  {{ end }}
</article>
</div>
{{ end }}